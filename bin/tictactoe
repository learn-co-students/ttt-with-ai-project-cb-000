#!/usr/bin/env ruby

require_relative '../config/environment'
def start
  input = ' '
  while input != 'quit'
    puts "Welcome to Tic Tac Toe!"
    puts "Which game mode would you like to play (0, 1, or 2 player)"
    puts "Enter \'quit\' or \'q\' to quit"
    input = STDIN.gets.chomp.downcase
    case input
    when '0'
      computer
    when '1'
      one_player
    when '2'
      two_player
    when 'quit','q'
      input = 'quit'
    end
  end
end

def computer
  if first_token == 'X'
    player_1 = Players::Computer.new('X')
    player_2 = Players::Computer.new('O')
  else
    player_1 = Players::Computer.new('O')
    player_2 = Players::Computer.new('X')
  end
  Game.new(player_1, player_2).play
end

def one_player
  start_first = play_first?
  token = pick_token
  if start_first
    if token == 'X'
      player_1 = Players::Human.new('X')
      player_2 = Players::Computer.new('O')
    else
      player_1 = Players::Human.new('O')
      player_2 = Players::Computer.new('X')
    end
  else
    if token == 'X'
      player_1 = Players::Computer.new('O')
      player_2 = Players::Human.new('X')
    else
      player_1 = Players::Computer.new('X')
      player_2 = Players::Human.new('O')
    end
  end
  Game.new(player_1, player_2).play
end

def two_player
  token = first_token
  if token == 'X'
    player_1 = Players::Human.new('X')
    player_2 = Players::Human.new('O')
  else
    player_1 = Players::Human.new('O')
    player_2 = Players::Human.new('X')
  end
  Game.new(player_1, player_2).play
end



def play_first?
  puts "Would you like to go first? (enter \'yes\' or \'no\')"
  input = STDIN.gets.chomp.downcase
  case input
  when 'yes', 'y'
    true
  when 'no', 'n'
    false
  when other
    play_first?
  end
end

def pick_token
  puts "Would you like to be player \'X\' or \'O\'?"
  input = STDIN.gets.chomp.upcase
  if input == 'X' || input == 'O'
    input
  else
    pick_token
  end
end

def first_token
  puts "Would you like \'X\' or \'O\' to play first?"
  input = STDIN.gets.chomp.upcase
  if input == 'X' || input == 'O'
    input
  else
    first_token
  end
end

start
